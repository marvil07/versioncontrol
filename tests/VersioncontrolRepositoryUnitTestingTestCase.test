<?php
class VersioncontrolRepositoryUnitTestingTestCase extends DrupalWebTestCase {

  /**
   * Implementation of getInfo().
   */
  public static function getInfo() {
    return array(
      // FIXME
      'name' => t('Repository class unit tests'),
      'description' => t('Unit tests for the VersioncontrolRepository class.'),
      'group' => t('Version Control'),
    );
  }

  /**
   * Implementation of setUp().
   */
  function setUp() {
    // load core and fake test backend modules
    parent::setUp('versioncontrol', 'versioncontrol_test');
    require_once drupal_get_path('module', 'versioncontrol') .'/includes/VersioncontrolRepository.php';
  }

  public function testGetRepositoryEmptyParam() {
    $repo_id = '';
    $repository = VersioncontrolRepository::getRepository($repo_id);
    $this->assertNull($repository, t('Make sure we get a NULL when trying to get a repository with empty repo_id'), 'getRepository');
  }

  public function testGetRepositoryNullParam() {
    $repo_id = NULL;
    $repository = VersioncontrolRepository::getRepository($repo_id);
    $this->assertNull($repository, t('Make sure we get a NULL when trying to get a repository with a NULL repo_id'), 'getRepository');
  }

  public function testGetRepositoryNotFound() {
    $repo_id = -1;
    $repository = VersioncontrolRepository::getRepository($repo_id);
    $this->assertNull($repository, t('Make sure we get a NULL when trying to get a repository which do not exit'), 'getRepository');
  }

  public function testGetRepositoryFound() {
    $repo = new VersioncontrolRepository(NULL, 'test repository', 'test', '', 'versioncontrol_admin', '');
    $repo->insert(array());
    $repository = VersioncontrolRepository::getRepository($repo->repo_id);
    $this->assertTrue(is_a($repository, 'VersioncontrolRepository'), t('Make sure we get a valid return when passing a good repo_id.'), 'getRepository');
  }

}
